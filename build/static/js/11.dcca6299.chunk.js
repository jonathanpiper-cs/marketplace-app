(this["webpackJsonpmarketplace-app-boilerplate"]=this["webpackJsonpmarketplace-app-boilerplate"]||[]).push([[11],{1324:function(e,t,a){"use strict";a.r(t);var n=a(4),c=a(6),r=a(5),i=a(0),s=a(28),o=a.n(s),l=a(138),u=a(95),b=(a(104),a(8)),m=a(1);t.default=function(){var e=Object(i.useState)([]),t=Object(r.a)(e,2),a=t[0],s=t[1],j=Object(l.a)(),p=(j.customFieldPointer,j.setFieldData),d=Object(i.useState)({}),f=Object(r.a)(d,2),O=f[0],h=f[1],g=Object(i.useState)(!1),x=Object(r.a)(g,2),v=x[0],y=x[1],D=Object(i.useState)(!1),k=Object(r.a)(D,2),I=k[0],N=k[1],S=Object(i.useState)({primaryImageSmall:"",title:"",objectDate:"",artistDisplayName:"",medium:""}),w=Object(r.a)(S,2),F=w[0],E=w[1],C=Object(i.useState)(""),M=Object(r.a)(C,2),_=M[0],H=M[1],z=Object(i.useState)({}),J=Object(r.a)(z,2),P=J[0],R=J[1],U=function(){var e=Object(c.a)(Object(n.a)().mark((function e(t){var c,r,i,o,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.get("badObjIDs").then((function(e){return s(e)})),e.next=3,fetch("https://collectionapi.metmuseum.org/public/collection/v1/search?q=".concat(t));case 3:return c=e.sent,e.next=6,c.json();case 6:if(null!==(r=e.sent).objectIDs&&0!==r.length){e.next=11;break}return y(!0),N(!1),e.abrupt("return");case 11:if(!I){e.next=43;break}if(o=r.objectIDs[Math.floor(Math.random()*r.objectIDs.length)],l=void 0,u={primaryImageSmall:"",title:"",objectDate:"",artistDisplayName:"",medium:""},e.prev=15,-1!==a.indexOf(o)){e.next=25;break}return e.next=19,fetch("https://collectionapi.metmuseum.org/public/collection/v1/objects/".concat(o));case 19:return l=e.sent,e.next=22,l.json();case 22:u=e.sent,e.next=26;break;case 25:console.log("We already know that object ".concat(o," doesn't have an associated image."));case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),console.log(e.t0);case 31:if(null===(i=u)||void 0===i||!i.primaryImageSmall||""===u.primaryImageSmall){e.next=35;break}return console.log("got an image!"),E(u),e.abrupt("break",43);case 35:a.push(o),s(a),O.set("badObjIDs",a),O.get("badObjIDs").then((function(e){return console.log("IDs without images: "+e)})),r.objectIDs.splice(r.objectIDs.indexOf(o),1),0==r.objectIDs.length&&y(!0),e.next=11;break;case 43:case"end":return e.stop()}}),e,null,[[15,28]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(c.a)(Object(n.a)().mark((function e(){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N(!0),y(!1),E({primaryImageSmall:"",title:"",objectDate:"",artistDisplayName:"",medium:""}),H("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){I&&U(P.entry._data.title)}),[I]),Object(i.useEffect)((function(){""!==F.primaryImageSmall&&(H(F.primaryImageSmall),N(!1),P.frame.updateHeight())}),[F]);var A=function(){var e=Object(c.a)(Object(n.a)().mark((function e(){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(F);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){o.a.init().then(function(){var e=Object(c.a)(Object(n.a)().mark((function e(t){var a,c,r,i,s;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.location.CustomField;case 2:return r=e.sent,e.next=5,t.store;case 5:return i=e.sent,h(i),e.next=9,r.field.getData();case 9:s=e.sent,R(r),null===(a=r.frame)||void 0===a||null===(c=a.enableAutoResizing)||void 0===c||c.call(a),r.frame.enableResizing(),r.frame.updateHeight(400),Object(b.isEmpty)(s)||null===s||E(s);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(m.jsxs)("div",{className:"met-inspo-container",children:[Object(m.jsxs)("div",{className:"met-inspo-header",children:[Object(m.jsx)(u.b,{onClick:q,disabled:I,children:"Get inspired by an image from the Met"}),Object(m.jsx)(u.b,{onClick:A,children:"Save image to the Entry"})]}),v?Object(m.jsx)("div",{className:"met-no-image",children:Object(m.jsx)(u.i,{tagName:"p",text:"Hmm, couldn't find an object based on the Entry title (\"".concat(P.entry._data.title,'").')})}):Object(m.jsxs)("div",{className:"met-inspo-body",children:[Object(m.jsx)("div",{className:"met-inspo-col-left",children:I?Object(m.jsx)("p",{children:"Fetching image..."}):""!==F.primaryImageSmall?Object(m.jsx)("img",{className:"met-inspo-image",src:_}):Object(m.jsx)("div",{})}),Object(m.jsxs)("div",{className:"met-inspo-col-right",children:[Object(m.jsx)(u.g,{tagName:"h6",text:F.title}),Object(m.jsx)(u.i,{tagName:"p",text:F.artistDisplayName}),Object(m.jsx)(u.i,{tagName:"p",text:F.objectDate}),Object(m.jsx)(u.i,{tagName:"p",text:F.medium})]})]})]})}},138:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),c=a(31),r=function(){var e=Object(n.useContext)(c.a);return{customField:e.customField,setFieldData:e.setFieldData,loading:e.loading}}},97:function(e,t){function a(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=97},99:function(e,t){}}]);
//# sourceMappingURL=11.dcca6299.chunk.js.map