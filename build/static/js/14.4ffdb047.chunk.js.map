{"version":3,"sources":["containers/ConfigScreen/Constructor Ingest.tsx","../node_modules/systemjs/dist lazy groupOptions: {} namespace object"],"names":["ConstructorIngest","_useState","useState","_useState2","_slicedToArray","endpoint","_useState3","_useState4","headers","_useState5","_useState6","setConstructorData","_useState7","_useState8","constructorGroups","setConstructorGroups","_useState9","_useState10","setFetching","_useState11","_useState12","_useState13","_useState14","setUnsaved","_useState15","_useState16","setSdk","appConfig","useRef","fetchEndpoint","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","json","wrap","_context","prev","next","console","log","fetch","sent","groups","children","map","g","display_name","stop","apply","arguments","useEffect","_getAppConfiguration","_callee3","_config$configuration","_config$configuration2","config","_context3","current","getInstallationData","configuration","length","ContentstackAppSDK","init","then","_ref2","_callee2","appSdk","_appSdk$location$AppC","_context2","location","AppConfigWidget","installation","_x","getAppConfiguration","setInstallationData","serverConfiguration","_jsx","className","_jsxs","Button","buttonType","onClick","Object","keys","group","key","webpackEmptyAsyncContext","req","Promise","resolve","e","Error","code","module","exports","id"],"mappings":"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","file":"static/js/14.4ffdb047.chunk.js","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport localeTexts from \"../../common/locales/en-us/index\";\nimport parse from \"html-react-parser\";\nimport ContentstackAppSDK from \"@contentstack/app-sdk\";\nimport { Button } from \"@contentstack/venus-components\";\nimport Extension from \"@contentstack/app-sdk/dist/src/extension\";\nimport { IInstallationData, ValidationOptions } from \"@contentstack/app-sdk/dist/src/types\";\n\nconst ConstructorIngest = () => {\n  const [endpoint, setEndpoint] = useState(\n    \"https://ac.cnstrc.com/search/?key=key_FNlcaUSzF3ulbjoM&fmt_options[fields]=\"\n  );\n  const [headers, setHeaders] = useState({});\n  const [constructorData, setConstructorData] = useState<any>();\n  const [constructorGroups, setConstructorGroups] = useState<any>();\n  const [fetching, setFetching] = useState(false);\n  const [customField, setCustomField] = useState<any>();\n  const [unsaved, setUnsaved] = useState(false);\n  const [sdk, setSdk] = useState<any>();\n  // const [appConfig, setAppConfig] = useState<any>();\n  const appConfig = useRef<{\n    setInstallationData: (installationData: IInstallationData) => Promise<{ [key: string]: string }>;\n    getInstallationData: () => Promise<IInstallationData>;\n    setValidity: (isValid: boolean, options?: ValidationOptions | undefined) => void;\n  } | null>(null);\n\n  const fetchEndpoint = async () => {\n    console.log(`Fetching groups from Contructor.io endpoint`);\n    setFetching(true);\n    setUnsaved(true);\n    const response = await fetch(endpoint, { headers });\n    const json = await response.json();\n    console.log(json);\n    setConstructorData(json.response);\n    setConstructorGroups(\n      json.response.groups[0].children.map((g: any) => {\n        return g.display_name;\n      })\n    );\n  };\n\n  useEffect(() => {\n    async function getAppConfiguration() {\n      if (appConfig.current) {\n        const config = await appConfig.current.getInstallationData();\n        if (config.configuration?.constructorGroups && config.configuration?.constructorGroups.length > 0) {\n          setConstructorGroups(config.configuration.constructorGroups);\n        }\n        console.log(config);\n      }\n    }\n    ContentstackAppSDK.init()\n      .then(async (appSdk) => {\n        appConfig.current = appSdk.location.AppConfigWidget?.installation || null;\n        setSdk(appSdk);\n      })\n      .then(() => getAppConfiguration());\n  }, []);\n\n  useEffect(() => {\n    if (appConfig.current) {\n      appConfig.current.setInstallationData({ configuration: { constructorGroups }, serverConfiguration: {} });\n    }\n  }, [appConfig, constructorGroups]);\n\n  return (\n    <div className=\"app-config\">\n      <div className=\"app-config-container\">\n        <div className=\"constructor-cats-config\">\n          <Button buttonType=\"primary\" onClick={fetchEndpoint}>\n            Fetch groups\n          </Button>\n          {typeof constructorGroups === \"object\" && Object.keys(constructorGroups).length > 0 ? (\n            <div>\n              <ul>\n                {constructorGroups.map((group: any, key: any) => {\n                  return <li key={key}>{group}</li>;\n                })}\n              </ul>\n              <p>Click Save below to save these categories</p>\n            </div>\n          ) : (\n            \"\"\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ConstructorIngest;\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 97;"],"sourceRoot":""}